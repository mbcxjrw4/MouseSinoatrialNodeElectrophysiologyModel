#ifndef INITIAL_VALUE_H
#define INITIAL_VALUE_H

#include "single_cell.h"

void initial(double * state, MY_CELL * data);

/****** initial conditions *****/

void initial(double * state, MY_CELL * data)
{
    int i, NEQ, cell_type = data->cell_type;
    double ff, capacitance = data->capacitance;
    double *para;
    FILE *in_data;

    if(cell_type >=3)
    {
        NEQ = 42;
        if(capacitance>=0.025 && capacitance <0.03)
        {
            in_data = fopen ("FILE/Initial_value/SAN_initial_value_25.txt", "r");
        }
        else if(capacitance>=0.03 && capacitance<0.035)
        {
            in_data = fopen ("FILE/Initial_value/SAN_initial_value_30.txt", "r");        
        }
        else if(capacitance>=0.035 && capacitance<0.04)
        {
            in_data = fopen ("FILE/Initial_value/SAN_initial_value_35.txt", "r");
        }
        else if(capacitance>=0.04 && capacitance<0.045)
        {
            in_data = fopen ("FILE/Initial_value/SAN_initial_value_40.txt", "r");
        }
        else
        {
            in_data = fopen ("FILE/Initial_value/SAN_initial_value_45.txt", "r");
        }
    }
    if(cell_type==2 || cell_type ==1)
    {
        NEQ = 34;
        in_data = fopen ("FILE/Initial_value/ATRIUM_initial_value.txt", "r");
    }

    para = (double *)malloc((NEQ) * sizeof(double));

    for(i=0; i<NEQ; i++)
    {
        fscanf(in_data, "%lf ", &ff);
        para[i] = ff;
    }
    fclose(in_data);

    data->V = para[0];
    for(i=0; i<NEQ-1; i++)
        state[i] = para[i+1];

    free(para);
}


/*void initial(double * state, MY_CELL * data)
{
    int cell_type = data->cell_type;
    int HCN = data->HCN;

    if(cell_type>=3 && HCN ==0)
    {
		// data->V   = -78.7399792401;  
		// state[0]  = 0.0983095686;    
		// state[1]  = 0.4985085088;    
		// state[2]  = 0.0001522569;    
		// state[3]  = 0.3889335729;    
		// state[4]  = 0.4588815178;    
		// state[5]  = 0.9623025322;    
		// state[6]  = 0.0190307967;    
		// state[7]  = 0.9765593168;    
		// state[8]  = 0.0000004586;    
		// state[9]  = 0.9680216311;    
		// state[10] = 0.0000204885;    
		// state[11] = 0.0158583923;    
		// state[12] = 0.2123398169;    
		// state[13] = 0.4141719875;    
		// state[14] = 0.0263625771;    
		// state[15] = 0.0418775399;    
		// state[16] = 0.4662741597;    
		// state[17] = 0.0246287650;    
		// state[18] = 0.0736712413;    
		// state[19] = 0.0189810822;    
		// state[20] = 2.9177249688;    
		// state[21] = 0.0000692013;    
		// state[22] = 0.0105498141;    
		// state[23] = 0.1904522587;    
		// state[24] = 0.7151614463;    
		// state[25] = 0.0298128267;    
		// state[26] = 0.0229231267;    
		// state[27] = 0.0202008568;    
		// state[28] = 0.0000532657;    
		// state[29] = 0.6774772515;    
		// state[30] = 0.5732003695;    
		// state[31] = 7.8468703300;    
		// state[32] = 139.7251961438;  
		// state[33] = 0.6259357903;    
		// state[34] = 0.0000023174;    
		// state[35] = 0.0000013414;    
		// state[36] = 0.3623065921;    
		// state[37] = 0.0035353624;    
		// state[38] = 0.0012201670;

	    data->V   = -66.3229612271;
        state[0]  = 0.5414695736;
        state[1]  = 0.4194439083;
        state[2]  = 0.0012045069;
        state[3]  = 0.4015980048;
        state[4]  = 0.4443716733;
        state[5]  = 0.9311905877;
        state[6]  = 0.0149274305;
        state[7]  = 0.9954569057;
        state[8]  = 0.0000032018;
        state[9]  = 0.9803876891;
        state[10] = 0.0001517255;
        state[11] = 0.0059393764;
        state[12] = 0.3711720680;
        state[13] = 0.2611142220;
        state[14] = 0.0229855798;
        state[15] = 0.0957204864;
        state[16] = 0.4019204376;
        state[17] = 0.0228187889;
        state[18] = 0.0423702050;
        state[19] = 0.0934077407;
        state[20] = 1.6796634676;
        state[21] = 0.0000585852;
        state[22] = 0.0067263333;
        state[23] = 0.1368176747;
        state[24] = 0.7625471494;
        state[25] = 0.0253897300;
        state[26] = 0.0146822602;
        state[27] = 0.0963395663;
        state[28] = 0.0000338291;
        state[29] = 0.5800195877;
        state[30] = 0.7315779380;
        state[31] = 8.0688635191;
        state[32] = 139.6238173619;
        state[33] = 0.7558708143;
        state[34] = 0.0000001263;
        state[35] = 0.0000000388;
        state[36] = 0.2323750618;
        state[37] = 0.0042485437;
        state[38] = 0.0020114301;
    }
    else if (cell_type>=3 && HCN ==1)
    {
        data->V   = -68.3101290469;  
        state[0]  = 0.4376846972;   
        state[1]  = 0.4762247476;   
        state[2]  = 0.0008652404;   
        state[3]  = 0.5439424186;   
        state[4]  = 0.4037060549;   
        state[5]  = 0.9377157740;   
        state[6]  = 0.0131390048;   
        state[7]  = 0.9988218972;   
        state[8]  = 0.0000021347;   
        state[9]  = 0.9888637898;   
        state[10] = 0.0001082450;   
        state[11] = 0.0033351744;   
        state[12] = 0.3400608936;   
        state[13] = 0.4016476765;   
        state[14] = 0.0340392055;   
        state[15] = 0.0838635849;   
        state[16] = 0.5797617744;   
        state[17] = 0.0376992826;   
        state[18] = 0.0725314257;   
        state[19] = 0.1256040165;   
        state[20] = 1.4738445140;   
        state[21] = 0.0000451450;   
        state[22] = 0.0058732952;   
        state[23] = 0.1230475136;   
        state[24] = 0.7747139986;   
        state[25] = 0.0196087466;   
        state[26] = 0.0128349139;   
        state[27] = 0.1266395702;   
        state[28] = 0.0000295317;   
        state[29] = 0.7094823010;   
        state[30] = 0.7929294177;   
        state[31] = 7.7972004532;   
        state[32] = 139.8922951680;  
        state[33] = 0.7866519091;    
        state[34] = 0.0000000552;    
        state[35] = 0.0000000142;    
        state[36] = 0.2015940627;    
        state[37] = 0.0061219005;    
        state[38] = 0.0025325321;
    }
    else if(cell_type>=3 && HCN ==2)
    {
        data->V   = -66.4760385367;  
        state[0]  = 0.5332659890;    
        state[1]  = 0.4233809477;    
        state[2]  = 0.0011741357;    
        state[3]  = 0.4096730904;    
        state[4]  = 0.4414195059;    
        state[5]  = 0.9317257714;    
        state[6]  = 0.0147859269;    
        state[7]  = 0.9958330735;    
        state[8]  = 0.0000031011;    
        state[9]  = 0.9812489905;    
        state[10] = 0.0001477423;    
        state[11] = 0.0056961369;    
        state[12] = 0.3686902446;    
        state[13] = 0.2685207108;    
        state[14] = 0.0234983406;    
        state[15] = 0.0947497411;    
        state[16] = 0.4114456869;    
        state[17] = 0.0235031757;    
        state[18] = 0.0438074430;    
        state[19] = 0.0947503080;    
        state[20] = 1.6646061626;    
        state[21] = 0.0000576407;    
        state[22] = 0.0066645289;    
        state[23] = 0.1358058420;    
        state[24] = 0.7634411988;    
        state[25] = 0.0249861836;    
        state[26] = 0.0145485248;    
        state[27] = 0.0976423902;    
        state[28] = 0.0000335172;    
        state[29] = 0.5882036082;    
        state[30] = 0.7350690715;    
        state[31] = 8.0556802281;    
        state[32] = 139.6242188632;  
        state[33] = 0.7578534453;    
        state[34] = 0.0000001210;    
        state[35] = 0.0000000368;    
        state[36] = 0.2303924381;    
        state[37] = 0.0043335967;    
        state[38] = 0.0020348991;
    }
    else if(cell_type>=3 && HCN ==4)
     {
        data->V   = -66.7060517041;  
        state[0]  = 0.5231021912;    
        state[1]  = 0.4247082060;    
        state[2]  = 0.0011302677;    
        state[3]  = 0.4096267118;    
        state[4]  = 0.4427409353;    
        state[5]  = 0.9324338505;    
        state[6]  = 0.0149057514;    
        state[7]  = 0.9957256898;    
        state[8]  = 0.0000029714;    
        state[9]  = 0.9813328380;    
        state[10] = 0.0001425720;    
        state[11] = 0.0057554317;    
        state[12] = 0.3649966542;    
        state[13] = 0.2697687269;    
        state[14] = 0.0235362830;    
        state[15] = 0.0933131366;    
        state[16] = 0.4106972085;    
        state[17] = 0.0234193303;    
        state[18] = 0.0439883126;    
        state[19] = 0.0933268885;    
        state[20] = 1.6396099920;    
        state[21] = 0.0000561381;    
        state[22] = 0.0065645955;    
        state[23] = 0.1341276151;    
        state[24] = 0.7649240949;    
        state[25] = 0.0243635555;    
        state[26] = 0.0143318811;    
        state[27] = 0.0962984791;    
        state[28] = 0.0000330088;    
        state[29] = 0.5880473969;    
        state[30] = 0.7367269521;    
        state[31] = 7.9801876568;    
        state[32] = 139.7012747407;  
        state[33] = 0.7603581371;    
        state[34] = 0.0000001199;    
        state[35] = 0.0000000359;    
        state[36] = 0.2278877482;    
        state[37] = 0.0043090432;    
        state[38] = 0.0020224247;
    }
    else //if(cell_type == 2)
    {
        data->V   = -79.483746943722294986400811;
        state[0]  = 0.144729318012104229973502;
        state[1]  = 0.145524353040527881786304;
        state[2]  = 1094.235994523354065677267499;
        state[3]  = 1097.164430097618605941534042;
        state[4]  = 15.106978286244975961949422;
        state[5]  = 130.692989191772625190424151;
        state[6]  = 0.000000274856149631066460;
        state[7]  = 0.000550491055114625386403;
        state[8]  = 0.000159577230488408463444;
        state[9]  = 0.000106253553122151664910;
        state[10] = 0.014740865365881589479913;
        state[11] = 0.001867522073111673765189;
        state[12] = 0.151482458009483705874132;
        state[13] = 0.688211559169077502495782;
        state[14] = 0.006969514019214599967467;
        state[15] = 0.000000091010894885182139;
        state[16] = 0.000000000000000000000000;
        state[17] = 0.000342129204598514552720;
        state[18] = 0.018164363165707020364437;
        state[19] = 0.000001292060471749764506;
        state[20] = 0.000474459069611717803357;
        state[21] = 0.011317336767008967512993;
        state[22] = 0.000232276196030010512400;
        state[23] = 0.024737504670569544773517;
        state[24] = 0.544636670975752967827077;
        state[25] = 14069.354566467951372032985091;
        state[26] = 143890.207199362455867230892181;
        state[27] = 0.015193485838284533431808;
        state[28] = 0.999280460867399855651172;
        state[29] = 0.013849572710542849482418;
        state[30] = 0.000610520376011100974339;
        state[31] = 0.922284105616689275919384;
        state[32] = 0.021110339464337986997711;
    }
        // state[40] = 0.31;  //ach j 
        // state[41] = 0.98;   k

}// end of initial*/

#endif
